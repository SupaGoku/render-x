<!DOCTYPE html>
<html>
<head>
  <title>Debug State</title>
</head>
<body>
  <div id="app"></div>
  <script type="module">
    import { render, h, useState } from '../dist/index.js'

    const Counter = () => {
      console.log('[Counter] Rendering')
      const [count, setCount] = useState(0)
      console.log('[Counter] Count is:', count)

      return h('div', null,
        h('span', { id: 'count' }, `Count: ${count}`),
        h('button', {
          id: 'btn',
          onClick: () => {
            console.log('[Counter] Button clicked, updating to', count + 1)
            setCount(count + 1)
          }
        }, 'Increment')
      )
    }

    const container = document.getElementById('app')

    console.log('=== Initial render ===')
    render(container, h(Counter, null))

    window.testClick = () => {
      const button = document.getElementById('btn')
      const span = document.getElementById('count')

      console.log('Before click span text:', span?.textContent)

      if (button) {
        console.log('=== Clicking button ===')
        button.click()

        setTimeout(() => {
          console.log('After click span text:', document.getElementById('count')?.textContent)
        }, 50)
      }
    }

    console.log('Run testClick() to test state update')
  </script>
</body>
</html>